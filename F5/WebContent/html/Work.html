<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>工作安排</title>

		<link rel="stylesheet" href="../js/bootstrap/css/bootstrap.css" />
		<link rel="stylesheet" href="../css/work.css" />
		<link rel="stylesheet" type="text/css" href="../css/common.css"/>
		<link rel="stylesheet" href="../css/calstyle/documentation.css" />
		<link rel="stylesheet" href="../css/calstyle/jalendar.css" />
		
		<style type="text/css">
		
			.tab .nav-tabs li.active a,
			.tab .nav-tabs li a:hover{
		     background: linear-gradient(165deg, transparent 29%,#fff 80%);
		    border: none;
		    color: #fff;
		    font-size: 18px;
	        }
			
			.demo{
				background: #333335;
			}
			.tab .tab-content{
				position: absolute;
				left: -300px;
				background: #fff;
				width: 1000px;
			}
			
			body {
				background: #333335;
				background-size: cover;
				color: #33000D;
			}
			
			#head {
				width: 1000px;
				height: 50px;
				background: rgba(0, 0, 0, 0.5);
				margin: auto;
				background-image: url(../images/bg7.jpg);
				background-color: 	#545353;
				position: relative;
			}
			
			.carousel {
				width: 1000px;
				height: 400px;
				margin: auto;
			}
			
			.carousel-inner {
				height: 400px;
				overflow: hidden;
			}
			
			#caidan1 {
				width: 1000px;
				text-align: center;
				color: #F6F6F6;
				margin: auto;
			}
			
			#caidan2 {
				width: 1000px;
				text-align: center;
			}
			
			#zhongxin {
				background-color: #FFFFFF;
				width: 1000px;
				height: 800px;
				margin: auto;
			}
				
			.s1{
				padding: 5px;
			}

			
		</style>
	</head>

	<body>

		<!--用户名显示开始-->
		<nav id="head" class="navbar navbar-inverse navbar-fixed-top">
			<div class="container">

				<!--logoa标志-->
				<div class="navbar-header">
					<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#myCollapse1">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
					<a href="./cloud_oa/pages/index.jsp" class="navbar-brand">
						<img src="../images/logo1.png" height="20" />
					</a>
				</div>
				<!--LOGO标志-->

				<!--当前登录用户-->
				<form if="userform" action="">

				</form>
				<!--当前登录用户-->

			</div>
			<!--/.container-fluid-->
		</nav>
		<!--用户名显示结束-->

		<!--轮播图-->
		<div id="carousel-example-generic" class="carousel slide center-block" data-ride="carousel">

			<!--轮播图格格数-->
			<ol class="carousel-indicators">
				<li data-target="#carousel-example-generic" data-slide-to="0" class="active"></li>
				<li data-target="#carousel-example-generic" data-slide-to="1"></li>
			</ol>
			<!--轮播图格式-->

			<!--轮播图图片-->
			<div class="carousel-inner" role="listbox">
				<div class="item active">
					<img src="../images/19.jpg">
					<!--<div class="carousel-caption">
						图1
					</div>-->
				</div>
				<div class="item">
					<img src="../images/22.jpg">
					<!--<div class="carousel-caption">
						图2
					</div>-->
				</div>

			</div>
			<!--轮播图图片-->

			<!-- 轮播图左右移键 -->
			<a class="left carousel-control" href="#carousel-example-generic" role="button" data-slide="prev">
				<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
				<span class="sr-only">Previous</span>
			</a>
			<a class="right carousel-control" href="#carousel-example-generic" role="button" data-slide="next">
				<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
				<span class="sr-only">Next</span>
			</a>
			<!-- 轮播图左右移键 -->
		</div>
		<!--轮播图-->

		<!--菜单栏-->
		<nav class="navbar navbar-default" role="navigation" id="caidan1" style="text-align: center;">

			<div class="container-fluid" id="caidan2">
				<!--菜单栏头-->
				<div class="navbar-header" style="width: 120px;">
					<a class="navbar-brand" href="../index.html" style="text-align: center; margin: auto;">主页</a>
				</div>
				<!--菜单栏头-->

				<div>
					<ul class="nav navbar-nav">
						<li style="width: 120px;"><a href="personal_a.html">个人中心</a></li>

						<li style="width: 120px;"><a href="room_query.html">会议室</a></li>
						<li style="width: 120px;"><a href="Work.html">工作安排</a></li>
						<li style="width: 120px;"><a href="things.html">资产管理</a></li>
						<li style="width: 120px;"><a href="expatriate.html">外派信息</a></li>
						<li style="width: 120px;"><a href="carpage.html">车辆管理</a></li>
						<li style="width: 120px;"><a href="BusinessCard.html">名片夹</a></li>

					</ul>
				</div>

			</div>
		</nav>
		<!--菜单栏-->

		<!--个人中心栏开始-->
		<div id="zhongxin">

			<!--工作流开始-->
			<div class="demo">
				<div class="container">
					<div class="row">
						<div class="col-md-offset-3 col-md-6">
							<div class="tab" role="tabpanel">
								<!-- Nav tabs -->
								<ul class="nav nav-tabs" role="tablist">
									<li role="presentation" class="active"><a href="#Section1" aria-controls="home" role="tab" data-toggle="tab">全部工作</a></li>
									<li role="presentation"><a href="#Section2" aria-controls="profile" role="tab" data-toggle="tab">我的工作</a></li>
									<li role="presentation"><a href="#Section3" aria-controls="messages" role="tab" data-toggle="tab">安排工作</a></li>
									<li role="presentation"><a href="#Section4" aria-controls="messages" role="tab" data-toggle="tab">日程日历</a></li>
									
								</ul>

								<div class="tab-content tabs">
									<!-- 全部工作开始 -->
										<div role="tabpanel" class="tab-pane fade in active" id="Section1">
											<h3>全部工作</h3>
											
											<!--查询开始-->
										<big class="col-sm-1">搜索:</big>
										<div class="col-sm-5 s1" >
											<b>发送者：</b><input type="text"  placeholder="请输入发送人姓名" name="workFromName" id="search1"  />
											<button type="button" class="btn btn-primary " @click="searchFromName()">
												<span class="glyphicon glyphicon-search"></span>查询
											</button>
										</div>
										
										<div class="col-sm-5 s1" >
											<b>接收者：</b><input type="text"  placeholder="请输入接收人姓名" name="workToName" id="search2"  />
											<button type="button" class="btn btn-primary " @click="searchToName()">
												<span class="glyphicon glyphicon-search"></span>查询
											</button>
										</div>
										
										<div class="col-sm-1">
												<input type="checkbox"  id="queryAll" @click="query(1)"/>显示全部
										</div>
										<!--查询结束-->
											<div class=" col-sm-12 " id="div2">

												<table class="table table-hover table-bordered">
													<thead>
														<tr>
															<td>工作编号</td>
															<td>发送人</td>
															<td>接收人</td>
															<td>工作主题</td>
															<td>工作开始时间</td>
															<td>工作结束时间</td>
															<td>操作</td>
														</tr>
													</thead>
													<tbody>
														<tr v-for="(work,index) in workList">
															<td>{{work.workId}}</td>
															<td>{{work.workFromName}}</td>
															<td>{{work.workToName}}</td>
															<td>{{work.workTitle}}</td>
															<td>{{work.workTimeStart}}</td>
															<td>{{work.workTimeEnd}}</td>

															<td>
															<button type="button" class="btn btn-success btn-xs" @click="see(work.workId)">
																<span class="glyphicon glyphicon-search"></span>
																查看详细
															</button>
																<button type="button" class="btn btn-danger btn-xs" @click="del(index,work.workId)">
															<span class="glyphicon glyphicon-trash"></span>
															删除
														</button>
															</td>

														</tr>
													</tbody>
												</table>

												<div class="row" id="h11">
													<div class="col-sm-4">
														共{{pager.recordCount}}条数据，每页{{pager.pageSize}}条，{{pager.pageNum}}/{{pager.pageCount}}
													</div>
													<div class="col-sm-8">
														<nav>
															<ul class="pagination pagination-sm  pull-right">
																<li v-show="pager.pageNum!=1"><a href="javascript:void(0);" @click="query(1)">首页</a></li>
																<li v-show="pager.pageNum!=1"><a href="javascript:void(0);" @click="query(pager.pageNum-1)">上页</a></li>
																<li v-show="pager.pageNum!=pager.pageCount"><a href="javascript:void(0);" @click="query(pager.pageNum+1)">下页</a></li>
																<li v-show="pager.pageNum!=pager.pageCount"><a href="javascript:void(0);" @click="query(pager.pageCount)">末页</a></li>
															</ul>
														</nav>
													</div>
												</div>

											</div>
										</div>
									<!--全部工作结束-->
									
									<!--我的工作开始-->
									<div role="tabpanel" class="tab-pane fade " id="Section2">
										<h3>我的工作</h3>
										
										<div class=" col-sm-12 s1">
											<table class="table table-hover table-bordered">
												<thead>
													<tr>
														<td>工作编号</td>
														<td>发送人</td>
														<td>工作主题</td>
														<td>工作开始时间</td>
														<td>工作结束时间</td>
														<td>状态</td>
														<td>操作</td>
														

													</tr>
												</thead>
												<tbody>
													<tr v-for="(work,index) in workList1">
														<td>{{work.workId}}</td>
														<td>{{work.workFromName}}</td>
														<td>{{work.workTitle}}</td>
														<td>{{work.workTimeStart}}</td>
														<td>{{work.workTimeEnd}}</td>
														<td>{{work.workAct}}</td>
														<td>
															<button type="button" class="btn btn-primary btn-xs" @click="toUpdate(work.workId)">
																<span class="glyphicon glyphicon-pencil"></span>
																修改
															</button>
															<button type="button" class="btn btn-danger btn-xs" @click="del(index,work.workId)">
																<span class="glyphicon glyphicon-trash"></span>
																删除
															</button>
															<button type="button" class="btn btn-success btn-xs" @click="see(work.workId)">
																<span class="glyphicon glyphicon-search"></span>
																查看详细
															</button>
														</td>
													</tr>
												</tbody>
											</table>

											<div class="row">
												<div class="col-sm-offset-8 col-sm-4">
													<button type="button" class="btn btn-success btn-block" @click="add()">增加新工作</button>
												</div>
											</div>
											
										</div>
									</div>
									<!--我的工作结束-->
									
									

									<!--工作安排开始-->
									<div role="tabpanel" class="tab-pane fade" id="Section3">
										<h3>安排工作</h3>
										<div class=" col-sm-12 ">
											<table class="table table-hover table-bordered">
												<thead>
													<tr>
														<td>接收人</td>
														<td>部门</td>
														<td>职务</td>
														<td>操作</td>

													</tr>
												</thead>
												<tbody>
													<tr v-for="(emp,index) in empList">
														<td>{{emp.empName}}</td>
														<td>{{emp.dept.deptName}}</td>
														<td>{{emp.job.jobName}}</td>

														<td>
															<button type="button" class="btn btn-primary btn-xs" @click="addwork(emp.empName)">
																<span class="glyphicon glyphicon-pencil"></span>
																安排工作
															</button>
														</td>
													</tr>
												</tbody>
											</table>

											<div class="row">
													<div class="col-sm-4">
														共{{pager.recordCount}}条数据，每页{{pager.pageSize}}条，{{pager.pageNum}}/{{pager.pageCount}}
													</div>
													<div class="col-sm-8">
														<nav>
															<ul class="pagination pagination-sm  pull-right">
																<li v-show="pager.pageNum!=1"><a href="javascript:void(0);" @click="query(1)">首页</a></li>
																<li v-show="pager.pageNum!=1"><a href="javascript:void(0);" @click="query(pager.pageNum-1)">上页</a></li>
																<li v-show="pager.pageNum!=pager.pageCount"><a href="javascript:void(0);" @click="query(pager.pageNum+1)">下页</a></li>
																<li v-show="pager.pageNum!=pager.pageCount"><a href="javascript:void(0);" @click="query(pager.pageCount)">末页</a></li>
															</ul>
														</nav>
													</div>
												</div>

										</div>
									</div>
									<!--工作安排结束-->
									
									<!--日程开始-->
									<div role="tabpanel" class="tab-pane fade" id="Section4"><!---->
										<article>
										<div id="myId3" class="jalendar mid">
   										 	<div class="added-event" data-date="9/8/2013" data-time="Tüm Gün" data-title="WWDC 13 on San Francisco, LA"></div>
    										<div class="added-event" data-date="16/8/2013" data-time="20:45" data-title="Tarkan İstanbul Concert on Harbiye Açık Hava Tiyatrosu"></div>
    										<div class="added-event" data-date="17/8/2013" data-time="21:00" data-title="CodeCanyon İstanbul Meeting on Starbucks, Kadıköy"></div>
    										<div class="added-event" data-date="17/8/2013" data-time="22:00" data-title="Front-End Design and Javascript Conferance on Haliç Kongre Merkezi"></div>
    										<div class="added-event" data-date="17/12/2017" data-time="22:00" data-title="Lorem ipsum dolor sit amet"></div>
										</div>
										</article>
									</div>
									<!--日程结束-->
									
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>
			<!--工作流结束-->

		</div>
		<!--个人中心栏结束-->

		<!--尾部介绍开始-->
		<footer>
			<div class="container-fluid footer_style">
				<div class="col-md-6 col-md-offset-3 text-center">
					<h4><img src="../images/logo1.png" height="20"/></h4>
					<p>地址：金石滩</p>
					<p>dlnu</p>
				</div>
			</div>
		</footer>
		<!--尾部介绍结束-->

		
		<script type="text/javascript" src="../js/jquery-3.4.1.js"></script>
		<script type="text/javascript" src="../js/bootstrap/js/bootstrap.js"></script>
		<script type="text/javascript" src="../js/layer/layer.js"></script>
		<script type="text/javascript" src="../js/vue.js"></script>
		<script type="text/javascript" src="../js/URL.js"></script>
		<script type="text/javascript" src="../js/jalendar.js" ></script>

		<script>

			var one = new Vue({
				el: '#Section1',
				data: {
					workList: [],
					pager: {}
				},
				methods: {
					
					searchFromName:function(){
						var searchFromName = $('#search1').val();
						//调用后端功能
						$.getJSON(baseUrl + '/work/queryByFromName',{workFromName:searchFromName} ,function(data) {
							console.log(data);
							one.workList = data;
							$('#h11').hide();
						});
						setTimeout(function() {
								$('#search1').val('');
						}, 1000);
						
					},
					searchToName:function(){
						var searchToName = $('#search2').val();
						//调用后端功能
						$.getJSON(baseUrl + '/work/queryByToName',{workToName:searchToName} ,function(data) {
							console.log(data);
							one.workList = data;
							$('#h11').hide();
						});
						setTimeout(function() {
								$('#search2').val('');
						}, 1000);
					},

					//查询数据
					query: function(pageNum) {
						
						setTimeout(function() {
								$('#queryAll').val('');
						}, 1000);
						
						$('#h11').show();

						//请求参数
						var params = {
							pageNum: pageNum,
							pageSize: 7
						}

						//调用后端功能
						$.getJSON(baseUrl + '/work/queryByPage', params, function(data) {
							one.workList = data.list;
							one.pager = data.pager;
						});
					},
					//删除数据
					del: function(index, workId) {

						if (!window.confirm('确定要删除此工作吗')) {
							return;
						}

						//调用后端功能
						$.get(baseUrl + '/work/delete', {
							workId: workId
						}, function(data) {
							layer.msg('删除工作成功');

							setTimeout(function() {
								one.workList.splice(index, 1); //前端删除
							}, 1000);
						});

					},
					//修改方法
					toUpdate: function(workId) {
						layer.open({
							title: '修改工作',
							type: 2,
							area: ['650px', '650px'], //宽高
							content: 'updateWork.html?workId=' + workId
						});
					},
					
					//查看详细
					see:function(workId){
						layer.open({
							title: '查看详细',
							type: 2,
							area: ['650px', '700px'], //宽高
							content: 'queryAllWork.html?workId=' + workId
						});
					}
				},
				mounted: function() { //网页渲染完毕调用
					this.query(1);
				}
			});
			
			var two = new Vue({
				el: '#Section2',
				data: {
					workList1 : []
				},
				methods: {
					//查询数据
					query: function() {

						var empName;
						$.ajaxSettings.async = false;//把ajax设置为同步
						$.post(baseUrl+'/emp/queryByNameZsh',function(data1){
							empName = data1.empName;
							
						});
						$.ajaxSettings.async = true;//再把ajax设置回异步

						//调用后端功能
						$.getJSON(baseUrl + '/work/queryByToName',{workToName:empName}, function(data) {
							two.workList1 = data;
						});
					},

					//删除数据
					del: function(index, workId) {

						if (!window.confirm('确定要删除此工作吗')) {
							return;
						}

						//调用后端功能
						$.get(baseUrl + '/work/delete', {
							workId: workId
						}, function(data) {
							layer.msg('删除工作成功');

							setTimeout(function() {
								two.workList1.splice(index, 1); //前端删除
							}, 1000);
						});

					},
					//修改方法
					toUpdate: function(workId) {
						layer.open({
							title: '修改工作',
							type: 2,
							area: ['650px', '640px'], //宽高
							content: 'updateWork.html?workId=' + workId
						});
					},

					//增加方法
					add: function() {
						layer.open({
							title: '增加工作',
							type: 2,
							area: ['650px', '640px'], //宽高
							content: 'addWork.html'
						});
					},
					
					//查看详细
					see:function(workId){
						layer.open({
							title: '查看详细',
							type: 2,
							area: ['650px', '640px'], //宽高
							content: 'queryAllWork.html?workId=' + workId
						});
					}
				},
				mounted: function(){
					this.query();
				}
			});
		
			var three = new Vue({
				el:'#Section3',
				data:{
					empList:[],
					pager:{}
				},
				methods:{
					//查询数据
					query:function(pageNum){
						
						//请求参数
						var params = {
							pageNum:pageNum,
							pageSize:5
						}
						
						//调用后端功能
						$.getJSON(baseUrl + '/emp/queryByPageZsh',params,function(data){
							three.empList = data.list;	
							three.pager = data.pager;
						});						
					},
					
					//安排工作
					addwork: function(empName) {
						layer.open({
							title: '安排工作',
							type: 2,
							area: ['620px', '600px'],  //宽高
							content: 'sendWork.html?empName=' + empName
						});
					}
				},
				mounted:function(){
					this.query(1);
				}
			});
			
			$(function () {
    			$('#myId3').jalendar();
			});
			
		</script>
	</body>

</html>